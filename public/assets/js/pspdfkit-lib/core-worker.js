/*!
 * PSPDFKit for Web 2024.5.2 (https://pspdfkit.com/web)
 *
 * Copyright (c) 2016-2024 PSPDFKit GmbH. All rights reserved.
 *
 * THIS SOURCE CODE AND ANY ACCOMPANYING DOCUMENTATION ARE PROTECTED BY INTERNATIONAL COPYRIGHT LAW
 * AND MAY NOT BE RESOLD OR REDISTRIBUTED. USAGE IS BOUND TO THE PSPDFKIT LICENSE AGREEMENT.
 * UNAUTHORIZED REPRODUCTION OR DISTRIBUTION IS SUBJECT TO CIVIL AND CRIMINAL PENALTIES.
 * This notice may not be removed from this file.
 *
 * PSPDFKit uses several open source third-party components: https://pspdfkit.com/acknowledgements/web/
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PSPDFKit=t():e.PSPDFKit=t()}(globalThis,(()=>(()=>{var e={19662:(e,t,n)=>{var r=n(60614),o=n(66330),i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not a function")}},19670:(e,t,n)=>{var r=n(70111),o=String,i=TypeError;e.exports=function(e){if(r(e))return e;throw i(o(e)+" is not an object")}},41318:(e,t,n)=>{var r=n(45656),o=n(51400),i=n(26244),a=function(e){return function(t,n,a){var s,c=r(t),u=i(c),l=o(a,u);if(e&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},50206:(e,t,n)=>{var r=n(1702);e.exports=r([].slice)},84326:(e,t,n)=>{var r=n(1702),o=r({}.toString),i=r("".slice);e.exports=function(e){return i(o(e),8,-1)}},99920:(e,t,n)=>{var r=n(92597),o=n(53887),i=n(31236),a=n(3070);e.exports=function(e,t,n){for(var s=o(t),c=a.f,u=i.f,l=0;l<s.length;l++){var d=s[l];r(e,d)||n&&r(n,d)||c(e,d,u(t,d))}}},68880:(e,t,n)=>{var r=n(19781),o=n(3070),i=n(79114);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},79114:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},98052:(e,t,n)=>{var r=n(60614),o=n(3070),i=n(56339),a=n(13072);e.exports=function(e,t,n,s){s||(s={});var c=s.enumerable,u=void 0!==s.name?s.name:t;if(r(n)&&i(n,u,s),s.global)c?e[t]=n:a(t,n);else{try{s.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:o.f(e,t,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},13072:(e,t,n)=>{var r=n(17854),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},19781:(e,t,n)=>{var r=n(47293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:e=>{var t="object"==typeof document&&document.all,n=void 0===t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},80317:(e,t,n)=>{var r=n(17854),o=n(70111),i=r.document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},89363:e=>{e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},6833:(e,t,n)=>{var r=n(88113);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},35268:(e,t,n)=>{var r=n(84326),o=n(17854);e.exports="process"==r(o.process)},88113:(e,t,n)=>{var r=n(35005);e.exports=r("navigator","userAgent")||""},7392:(e,t,n)=>{var r,o,i=n(17854),a=n(88113),s=i.process,c=i.Deno,u=s&&s.versions||c&&c.version,l=u&&u.v8;l&&(o=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(o=+r[1]),e.exports=o},80748:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},82109:(e,t,n)=>{var r=n(17854),o=n(31236).f,i=n(68880),a=n(98052),s=n(13072),c=n(99920),u=n(54705);e.exports=function(e,t){var n,l,d,p,f,m=e.target,g=e.global,h=e.stat;if(n=g?r:h?r[m]||s(m,{}):(r[m]||{}).prototype)for(l in t){if(p=t[l],d=e.dontCallGetSet?(f=o(n,l))&&f.value:n[l],!u(g?l:m+(h?".":"#")+l,e.forced)&&void 0!==d){if(typeof p==typeof d)continue;c(p,d)}(e.sham||d&&d.sham)&&i(p,"sham",!0),a(n,l,p,e)}}},47293:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},22104:(e,t,n)=>{var r=n(34374),o=Function.prototype,i=o.apply,a=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(i):function(){return a.apply(i,arguments)})},49974:(e,t,n)=>{var r=n(21470),o=n(19662),i=n(34374),a=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:i?a(e,t):function(){return e.apply(t,arguments)}}},34374:(e,t,n)=>{var r=n(47293);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},46916:(e,t,n)=>{var r=n(34374),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},76530:(e,t,n)=>{var r=n(19781),o=n(92597),i=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=o(i,"name"),c=s&&"something"===function(){}.name,u=s&&(!r||r&&a(i,"name").configurable);e.exports={EXISTS:s,PROPER:c,CONFIGURABLE:u}},21470:(e,t,n)=>{var r=n(84326),o=n(1702);e.exports=function(e){if("Function"===r(e))return o(e)}},1702:(e,t,n)=>{var r=n(34374),o=Function.prototype,i=o.call,a=r&&o.bind.bind(i,i);e.exports=r?a:function(e){return function(){return i.apply(e,arguments)}}},35005:(e,t,n)=>{var r=n(17854),o=n(60614),i=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e]):r[e]&&r[e][t]}},58173:(e,t,n)=>{var r=n(19662),o=n(68554);e.exports=function(e,t){var n=e[t];return o(n)?void 0:r(n)}},17854:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},92597:(e,t,n)=>{var r=n(1702),o=n(47908),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},3501:e=>{e.exports={}},60490:(e,t,n)=>{var r=n(35005);e.exports=r("document","documentElement")},64664:(e,t,n)=>{var r=n(19781),o=n(47293),i=n(80317);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},68361:(e,t,n)=>{var r=n(1702),o=n(47293),i=n(84326),a=Object,s=r("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?s(e,""):a(e)}:a},42788:(e,t,n)=>{var r=n(1702),o=n(60614),i=n(5465),a=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return a(e)}),e.exports=i.inspectSource},29909:(e,t,n)=>{var r,o,i,a=n(94811),s=n(17854),c=n(70111),u=n(68880),l=n(92597),d=n(5465),p=n(6200),f=n(3501),m="Object already initialized",g=s.TypeError,h=s.WeakMap;if(a||d.state){var y=d.state||(d.state=new h);y.get=y.get,y.has=y.has,y.set=y.set,r=function(e,t){if(y.has(e))throw g(m);return t.facade=e,y.set(e,t),t},o=function(e){return y.get(e)||{}},i=function(e){return y.has(e)}}else{var b=p("state");f[b]=!0,r=function(e,t){if(l(e,b))throw g(m);return t.facade=e,u(e,b,t),t},o=function(e){return l(e,b)?e[b]:{}},i=function(e){return l(e,b)}}e.exports={set:r,get:o,has:i,enforce:function(e){return i(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw g("Incompatible receiver, "+e+" required");return n}}}},60614:(e,t,n)=>{var r=n(4154),o=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===o}:function(e){return"function"==typeof e}},54705:(e,t,n)=>{var r=n(47293),o=n(60614),i=/#|\.prototype\./,a=function(e,t){var n=c[s(e)];return n==l||n!=u&&(o(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=a.data={},u=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},68554:e=>{e.exports=function(e){return null==e}},70111:(e,t,n)=>{var r=n(60614),o=n(4154),i=o.all;e.exports=o.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===i}:function(e){return"object"==typeof e?null!==e:r(e)}},31913:e=>{e.exports=!1},52190:(e,t,n)=>{var r=n(35005),o=n(60614),i=n(47976),a=n(43307),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&i(t.prototype,s(e))}},26244:(e,t,n)=>{var r=n(17466);e.exports=function(e){return r(e.length)}},56339:(e,t,n)=>{var r=n(47293),o=n(60614),i=n(92597),a=n(19781),s=n(76530).CONFIGURABLE,c=n(42788),u=n(29909),l=u.enforce,d=u.get,p=Object.defineProperty,f=a&&!r((function(){return 8!==p((function(){}),"length",{value:8}).length})),m=String(String).split("String"),g=e.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!i(e,"name")||s&&e.name!==t)&&(a?p(e,"name",{value:t,configurable:!0}):e.name=t),f&&n&&i(n,"arity")&&e.length!==n.arity&&p(e,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?a&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=l(e);return i(r,"source")||(r.source=m.join("string"==typeof t?t:"")),e};Function.prototype.toString=g((function(){return o(this)&&d(this).source||c(this)}),"toString")},74758:e=>{var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},3070:(e,t,n)=>{var r=n(19781),o=n(64664),i=n(3353),a=n(19670),s=n(34948),c=TypeError,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d="enumerable",p="configurable",f="writable";t.f=r?i?function(e,t,n){if(a(e),t=s(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&f in n&&!n.writable){var r=l(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:p in n?n.configurable:r.configurable,enumerable:d in n?n.enumerable:r.enumerable,writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(a(e),t=s(t),a(n),o)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},31236:(e,t,n)=>{var r=n(19781),o=n(46916),i=n(55296),a=n(79114),s=n(45656),c=n(34948),u=n(92597),l=n(64664),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=s(e),t=c(t),l)try{return d(e,t)}catch(e){}if(u(e,t))return a(!o(i.f,e,t),e[t])}},8006:(e,t,n)=>{var r=n(16324),o=n(80748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},25181:(e,t)=>{t.f=Object.getOwnPropertySymbols},47976:(e,t,n)=>{var r=n(1702);e.exports=r({}.isPrototypeOf)},16324:(e,t,n)=>{var r=n(1702),o=n(92597),i=n(45656),a=n(41318).indexOf,s=n(3501),c=r([].push);e.exports=function(e,t){var n,r=i(e),u=0,l=[];for(n in r)!o(s,n)&&o(r,n)&&c(l,n);for(;t.length>u;)o(r,n=t[u++])&&(~a(l,n)||c(l,n));return l}},55296:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},92140:(e,t,n)=>{var r=n(46916),o=n(60614),i=n(70111),a=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&o(n=e.toString)&&!i(s=r(n,e)))return s;if(o(n=e.valueOf)&&!i(s=r(n,e)))return s;if("string"!==t&&o(n=e.toString)&&!i(s=r(n,e)))return s;throw a("Can't convert object to primitive value")}},53887:(e,t,n)=>{var r=n(35005),o=n(1702),i=n(8006),a=n(25181),s=n(19670),c=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(s(e)),n=a.f;return n?c(t,n(e)):t}},84488:(e,t,n)=>{var r=n(68554),o=TypeError;e.exports=function(e){if(r(e))throw o("Can't call method on "+e);return e}},17152:(e,t,n)=>{"use strict";var r,o=n(17854),i=n(22104),a=n(60614),s=n(89363),c=n(88113),u=n(50206),l=n(48053),d=o.Function,p=/MSIE .\./.test(c)||s&&((r=o.Bun.version.split(".")).length<3||0==r[0]&&(r[1]<3||3==r[1]&&0==r[2]));e.exports=function(e,t){var n=t?2:1;return p?function(r,o){var s=l(arguments.length,1)>n,c=a(r)?r:d(r),p=s?u(arguments,n):[],f=s?function(){i(c,this,p)}:c;return t?e(f,o):e(f)}:e}},6200:(e,t,n)=>{var r=n(72309),o=n(69711),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},5465:(e,t,n)=>{var r=n(17854),o=n(13072),i="__core-js_shared__",a=r[i]||o(i,{});e.exports=a},72309:(e,t,n)=>{var r=n(31913),o=n(5465);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.27.1",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},36293:(e,t,n)=>{var r=n(7392),o=n(47293);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},20261:(e,t,n)=>{var r,o,i,a,s=n(17854),c=n(22104),u=n(49974),l=n(60614),d=n(92597),p=n(47293),f=n(60490),m=n(50206),g=n(80317),h=n(48053),y=n(6833),b=n(35268),w=s.setImmediate,v=s.clearImmediate,_=s.process,O=s.Dispatch,S=s.Function,F=s.MessageChannel,x=s.String,I=0,E={},j="onreadystatechange";try{r=s.location}catch(e){}var A=function(e){if(d(E,e)){var t=E[e];delete E[e],t()}},D=function(e){return function(){A(e)}},P=function(e){A(e.data)},k=function(e){s.postMessage(x(e),r.protocol+"//"+r.host)};w&&v||(w=function(e){h(arguments.length,1);var t=l(e)?e:S(e),n=m(arguments,1);return E[++I]=function(){c(t,void 0,n)},o(I),I},v=function(e){delete E[e]},b?o=function(e){_.nextTick(D(e))}:O&&O.now?o=function(e){O.now(D(e))}:F&&!y?(a=(i=new F).port2,i.port1.onmessage=P,o=u(a.postMessage,a)):s.addEventListener&&l(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!p(k)?(o=k,s.addEventListener("message",P,!1)):o=j in g("script")?function(e){f.appendChild(g("script")).onreadystatechange=function(){f.removeChild(this),A(e)}}:function(e){setTimeout(D(e),0)}),e.exports={set:w,clear:v}},51400:(e,t,n)=>{var r=n(19303),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},45656:(e,t,n)=>{var r=n(68361),o=n(84488);e.exports=function(e){return r(o(e))}},19303:(e,t,n)=>{var r=n(74758);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},17466:(e,t,n)=>{var r=n(19303),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},47908:(e,t,n)=>{var r=n(84488),o=Object;e.exports=function(e){return o(r(e))}},57593:(e,t,n)=>{var r=n(46916),o=n(70111),i=n(52190),a=n(58173),s=n(92140),c=n(5112),u=TypeError,l=c("toPrimitive");e.exports=function(e,t){if(!o(e)||i(e))return e;var n,c=a(e,l);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!o(n)||i(n))return n;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},34948:(e,t,n)=>{var r=n(57593),o=n(52190);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},66330:e=>{var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},69711:(e,t,n)=>{var r=n(1702),o=0,i=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++o+i,36)}},43307:(e,t,n)=>{var r=n(36293);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(e,t,n)=>{var r=n(19781),o=n(47293);e.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},48053:e=>{var t=TypeError;e.exports=function(e,n){if(e<n)throw t("Not enough arguments");return e}},94811:(e,t,n)=>{var r=n(17854),o=n(60614),i=r.WeakMap;e.exports=o(i)&&/native code/.test(String(i))},5112:(e,t,n)=>{var r=n(17854),o=n(72309),i=n(92597),a=n(69711),s=n(36293),c=n(43307),u=o("wks"),l=r.Symbol,d=l&&l.for,p=c?l:l&&l.withoutSetter||a;e.exports=function(e){if(!i(u,e)||!s&&"string"!=typeof u[e]){var t="Symbol."+e;s&&i(l,e)?u[e]=l[e]:u[e]=c&&d?d(t):p(t)}return u[e]}},11091:(e,t,n)=>{var r=n(82109),o=n(17854),i=n(20261).clear;r({global:!0,bind:!0,enumerable:!0,forced:o.clearImmediate!==i},{clearImmediate:i})},84633:(e,t,n)=>{n(11091),n(12986)},12986:(e,t,n)=>{var r=n(82109),o=n(17854),i=n(20261).set,a=n(17152),s=o.setImmediate?a(i,!1):i;r({global:!0,bind:!0,enumerable:!0,forced:o.setImmediate!==s},{setImmediate:s})},52923:()=>{},91117:e=>{e.exports="aaaa7d3fc4dc9731"},35349:e=>{e.exports="89af39116f34af6a"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r);n(84633);"object"==typeof window&&(window._babelPolyfill=!1);const e=function e(t){let n;return n=t instanceof Error?t:new Error(t),Object.setPrototypeOf(n,e.prototype),n};e.prototype=Object.create(Error.prototype,{name:{value:"PSPDFKitError",enumerable:!1}});const t=e;function o(e,n){if(!e)throw new t(`Assertion failed: ${n||"Condition not met"}\n\nFor further assistance, please go to: https://pspdfkit.com/support/request`)}function i(e){console.log(e)}function a(){console.warn(...arguments)}function s(e){console.error(e)}["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'].join(",");function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}function l(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}new WeakMap;const d="function"==typeof Buffer,p=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),f=(e=>{let t={};return e.forEach(((e,n)=>t[e]=n)),t})(p),m=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,g=String.fromCharCode.bind(String),h="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),y=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),b=e=>{let t,n,r,o,i="";const a=e.length%3;for(let a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255||(o=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=n<<16|r<<8|o,i+=p[t>>18&63]+p[t>>12&63]+p[t>>6&63]+p[63&t]}return a?i.slice(0,a-3)+"===".substring(a):i},w=e=>{if(e=e.replace(/\s+/g,""),!m.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,r,o="";for(let i=0;i<e.length;)t=f[e.charAt(i++)]<<18|f[e.charAt(i++)]<<12|(n=f[e.charAt(i++)])<<6|(r=f[e.charAt(i++)]),o+=64===n?g(t>>16&255):64===r?g(t>>16&255,t>>8&255):g(t>>16&255,t>>8&255,255&t);return o},v="function"==typeof atob?e=>atob(y(e)):d?e=>Buffer.from(e,"base64").toString("binary"):w,_=d?e=>h(Buffer.from(e,"base64")):e=>h(v(e).split("").map((e=>e.charCodeAt(0)))),O=e=>_(S(e)),S=e=>y(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),F=O;function x(e){return{name:e.name,scale:{unitFrom:e.scale.unitFrom,unitTo:e.scale.unitTo,from:Number(e.scale.fromValue),to:Number(e.scale.toValue)},precision:e.precision}}var I=n(91117),E=n.n(I),j=n(35349),A=n.n(j),D=n(52923),P=n.n(D);let k;k="object"==typeof process&&"object"==typeof process.versions&&void 0!==process.versions.node?P():function(e){return"object"==typeof window?new Promise(((t,n)=>{const r=document.createElement("script");r.type="text/javascript",r.async=!0,r.onload=()=>t(window.PSPDFModuleInit),r.onerror=n,r.src=e;const{documentElement:i}=document;o(i),i.appendChild(r)})):(self.importScripts(e),Promise.resolve(self.PSPDFModuleInit))};const T=k,C="pspdfkit-lib/",N=`${C}pspdfkit${"-"+A()}.wasm.js`,B=`${C}pspdfkit${"-"+E()}.wasm`;function $(e,t){let n;if("object"==typeof e){n=e.wasm;return{wasmBinaryFile:B,locateFile:e=>e,wasmBinary:n}}const r={wasmBinaryFile:e+B,locateFile:e=>e,wasmBinary:n};{const e=fetch(r.wasmBinaryFile,{credentials:"same-origin"}),n=13693236;e.then((e=>{const t=e.headers.get("content-length");return t&&parseInt(t)>=n&&a("The WASM binary file is being served without compression. Due to its size, it's recommended to configure the server so application/wasm files are served with compression.\n\nFind more details in our Standalone performance guides: https://pspdfkit.com/guides/web/best-practices/caching-on-the-web/#gzip-and-brotli"),e})).catch((e=>{throw new Error(`Failed to load WASM binary file: ${e}`)})),r.instantiateWasm=(n,o)=>((async()=>{i(`Start ${r.wasmBinaryFile} download.`);const a=Date.now();let c,u;const l=!t&&"function"==typeof WebAssembly.instantiateStreaming;function d(){return e.then((e=>{if(!e.ok)throw new Error(`Error loading ${r.wasmBinaryFile}: ${e.statusText}`);return e.arrayBuffer()})).then((e=>(u=Date.now(),i(`Download complete, took: ${u-a}ms`),WebAssembly.instantiate(new Uint8Array(e),n))))}c=l?WebAssembly.instantiateStreaming(e,n).then((e=>(u=Date.now(),i(`Download and Instantiation complete, took: ${Date.now()-a}ms`),e))).catch((e=>{if(/mime.*type/i.test(e.message))return s(e.message),null;throw e})):d();let p=await c;null===p&&(s("Streaming instantiation failed! Falling back to classic instantiation. This might result in slower initialization time therefore we highly recommend to follow the troubleshooting instructions in our guides to fix this error: https://pspdfkit.com/guides/web/current/troubleshooting/common-issues/#response-has-unsupported-mime-type-error."),p=await d()),!l&&u&&i(`Compilation and Instantiation complete, took: ${Date.now()-u}ms`),o(p.instance,p.module)})(),{})}return r}function M(e){e.PSPDFLoggingServices={error(e,t){s(`[${e}] ${t}`)},warn(e,t){a(`[${e}] ${t}`)},info(e,t){0},debug(e,t){0},trace(e,t){0}},e.PSPDFUnicodeServices={stripDiacritics(e){const t={Á:"A",Ă:"A",Ắ:"A",Ặ:"A",Ằ:"A",Ẳ:"A",Ẵ:"A",Ǎ:"A",Â:"A",Ấ:"A",Ậ:"A",Ầ:"A",Ẩ:"A",Ẫ:"A",Ä:"A",Ǟ:"A",Ȧ:"A",Ǡ:"A",Ạ:"A",Ȁ:"A",À:"A",Ả:"A",Ȃ:"A",Ā:"A",Ą:"A",Å:"A",Ǻ:"A",Ḁ:"A",Ⱥ:"A",Ã:"A",Ꜳ:"AA",Æ:"AE",Ǽ:"AE",Ǣ:"AE",Ꜵ:"AO",Ꜷ:"AU",Ꜹ:"AV",Ꜻ:"AV",Ꜽ:"AY",Ḃ:"B",Ḅ:"B",Ɓ:"B",Ḇ:"B",Ƀ:"B",Ƃ:"B",Ć:"C",Č:"C",Ç:"C",Ḉ:"C",Ĉ:"C",Ċ:"C",Ƈ:"C",Ȼ:"C",Ď:"D",Ḑ:"D",Ḓ:"D",Ḋ:"D",Ḍ:"D",Ɗ:"D",Ḏ:"D",ǲ:"D",ǅ:"D",Đ:"D",Ƌ:"D",Ǳ:"DZ",Ǆ:"DZ",É:"E",Ĕ:"E",Ě:"E",Ȩ:"E",Ḝ:"E",Ê:"E",Ế:"E",Ệ:"E",Ề:"E",Ể:"E",Ễ:"E",Ḙ:"E",Ë:"E",Ė:"E",Ẹ:"E",Ȅ:"E",È:"E",Ẻ:"E",Ȇ:"E",Ē:"E",Ḗ:"E",Ḕ:"E",Ę:"E",Ɇ:"E",Ẽ:"E",Ḛ:"E",Ꝫ:"ET",Ḟ:"F",Ƒ:"F",Ǵ:"G",Ğ:"G",Ǧ:"G",Ģ:"G",Ĝ:"G",Ġ:"G",Ɠ:"G",Ḡ:"G",Ǥ:"G",Ḫ:"H",Ȟ:"H",Ḩ:"H",Ĥ:"H",Ⱨ:"H",Ḧ:"H",Ḣ:"H",Ḥ:"H",Ħ:"H",Í:"I",Ĭ:"I",Ǐ:"I",Î:"I",Ï:"I",Ḯ:"I",İ:"I",Ị:"I",Ȉ:"I",Ì:"I",Ỉ:"I",Ȋ:"I",Ī:"I",Į:"I",Ɨ:"I",Ĩ:"I",Ḭ:"I",Ꝺ:"D",Ꝼ:"F",Ᵹ:"G",Ꞃ:"R",Ꞅ:"S",Ꞇ:"T",Ꝭ:"IS",Ĵ:"J",Ɉ:"J",Ḱ:"K",Ǩ:"K",Ķ:"K",Ⱪ:"K",Ꝃ:"K",Ḳ:"K",Ƙ:"K",Ḵ:"K",Ꝁ:"K",Ꝅ:"K",Ĺ:"L",Ƚ:"L",Ľ:"L",Ļ:"L",Ḽ:"L",Ḷ:"L",Ḹ:"L",Ⱡ:"L",Ꝉ:"L",Ḻ:"L",Ŀ:"L",Ɫ:"L",ǈ:"L",Ł:"L",Ǉ:"LJ",Ḿ:"M",Ṁ:"M",Ṃ:"M",Ɱ:"M",Ń:"N",Ň:"N",Ņ:"N",Ṋ:"N",Ṅ:"N",Ṇ:"N",Ǹ:"N",Ɲ:"N",Ṉ:"N",Ƞ:"N",ǋ:"N",Ñ:"N",Ǌ:"NJ",Ó:"O",Ŏ:"O",Ǒ:"O",Ô:"O",Ố:"O",Ộ:"O",Ồ:"O",Ổ:"O",Ỗ:"O",Ö:"O",Ȫ:"O",Ȯ:"O",Ȱ:"O",Ọ:"O",Ő:"O",Ȍ:"O",Ò:"O",Ỏ:"O",Ơ:"O",Ớ:"O",Ợ:"O",Ờ:"O",Ở:"O",Ỡ:"O",Ȏ:"O",Ꝋ:"O",Ꝍ:"O",Ō:"O",Ṓ:"O",Ṑ:"O",Ɵ:"O",Ǫ:"O",Ǭ:"O",Ø:"O",Ǿ:"O",Õ:"O",Ṍ:"O",Ṏ:"O",Ȭ:"O",Ƣ:"OI",Ꝏ:"OO",Ɛ:"E",Ɔ:"O",Ȣ:"OU",Ṕ:"P",Ṗ:"P",Ꝓ:"P",Ƥ:"P",Ꝕ:"P",Ᵽ:"P",Ꝑ:"P",Ꝙ:"Q",Ꝗ:"Q",Ŕ:"R",Ř:"R",Ŗ:"R",Ṙ:"R",Ṛ:"R",Ṝ:"R",Ȑ:"R",Ȓ:"R",Ṟ:"R",Ɍ:"R",Ɽ:"R",Ꜿ:"C",Ǝ:"E",Ś:"S",Ṥ:"S",Š:"S",Ṧ:"S",Ş:"S",Ŝ:"S",Ș:"S",Ṡ:"S",Ṣ:"S",Ṩ:"S",Ť:"T",Ţ:"T",Ṱ:"T",Ț:"T",Ⱦ:"T",Ṫ:"T",Ṭ:"T",Ƭ:"T",Ṯ:"T",Ʈ:"T",Ŧ:"T",Ɐ:"A",Ꞁ:"L",Ɯ:"M",Ʌ:"V",Ꜩ:"TZ",Ú:"U",Ŭ:"U",Ǔ:"U",Û:"U",Ṷ:"U",Ü:"U",Ǘ:"U",Ǚ:"U",Ǜ:"U",Ǖ:"U",Ṳ:"U",Ụ:"U",Ű:"U",Ȕ:"U",Ù:"U",Ủ:"U",Ư:"U",Ứ:"U",Ự:"U",Ừ:"U",Ử:"U",Ữ:"U",Ȗ:"U",Ū:"U",Ṻ:"U",Ų:"U",Ů:"U",Ũ:"U",Ṹ:"U",Ṵ:"U",Ꝟ:"V",Ṿ:"V",Ʋ:"V",Ṽ:"V",Ꝡ:"VY",Ẃ:"W",Ŵ:"W",Ẅ:"W",Ẇ:"W",Ẉ:"W",Ẁ:"W",Ⱳ:"W",Ẍ:"X",Ẋ:"X",Ý:"Y",Ŷ:"Y",Ÿ:"Y",Ẏ:"Y",Ỵ:"Y",Ỳ:"Y",Ƴ:"Y",Ỷ:"Y",Ỿ:"Y",Ȳ:"Y",Ɏ:"Y",Ỹ:"Y",Ź:"Z",Ž:"Z",Ẑ:"Z",Ⱬ:"Z",Ż:"Z",Ẓ:"Z",Ȥ:"Z",Ẕ:"Z",Ƶ:"Z",Ĳ:"IJ",Œ:"OE",ᴀ:"A",ᴁ:"AE",ʙ:"B",ᴃ:"B",ᴄ:"C",ᴅ:"D",ᴇ:"E",ꜰ:"F",ɢ:"G",ʛ:"G",ʜ:"H",ɪ:"I",ʁ:"R",ᴊ:"J",ᴋ:"K",ʟ:"L",ᴌ:"L",ᴍ:"M",ɴ:"N",ᴏ:"O",ɶ:"OE",ᴐ:"O",ᴕ:"OU",ᴘ:"P",ʀ:"R",ᴎ:"N",ᴙ:"R",ꜱ:"S",ᴛ:"T",ⱻ:"E",ᴚ:"R",ᴜ:"U",ᴠ:"V",ᴡ:"W",ʏ:"Y",ᴢ:"Z",á:"a",ă:"a",ắ:"a",ặ:"a",ằ:"a",ẳ:"a",ẵ:"a",ǎ:"a",â:"a",ấ:"a",ậ:"a",ầ:"a",ẩ:"a",ẫ:"a",ä:"a",ǟ:"a",ȧ:"a",ǡ:"a",ạ:"a",ȁ:"a",à:"a",ả:"a",ȃ:"a",ā:"a",ą:"a",ᶏ:"a",ẚ:"a",å:"a",ǻ:"a",ḁ:"a",ⱥ:"a",ã:"a",ꜳ:"aa",æ:"ae",ǽ:"ae",ǣ:"ae",ꜵ:"ao",ꜷ:"au",ꜹ:"av",ꜻ:"av",ꜽ:"ay",ḃ:"b",ḅ:"b",ɓ:"b",ḇ:"b",ᵬ:"b",ᶀ:"b",ƀ:"b",ƃ:"b",ɵ:"o",ć:"c",č:"c",ç:"c",ḉ:"c",ĉ:"c",ɕ:"c",ċ:"c",ƈ:"c",ȼ:"c",ď:"d",ḑ:"d",ḓ:"d",ȡ:"d",ḋ:"d",ḍ:"d",ɗ:"d",ᶑ:"d",ḏ:"d",ᵭ:"d",ᶁ:"d",đ:"d",ɖ:"d",ƌ:"d",ı:"i",ȷ:"j",ɟ:"j",ʄ:"j",ǳ:"dz",ǆ:"dz",é:"e",ĕ:"e",ě:"e",ȩ:"e",ḝ:"e",ê:"e",ế:"e",ệ:"e",ề:"e",ể:"e",ễ:"e",ḙ:"e",ë:"e",ė:"e",ẹ:"e",ȅ:"e",è:"e",ẻ:"e",ȇ:"e",ē:"e",ḗ:"e",ḕ:"e",ⱸ:"e",ę:"e",ᶒ:"e",ɇ:"e",ẽ:"e",ḛ:"e",ꝫ:"et",ḟ:"f",ƒ:"f",ᵮ:"f",ᶂ:"f",ǵ:"g",ğ:"g",ǧ:"g",ģ:"g",ĝ:"g",ġ:"g",ɠ:"g",ḡ:"g",ᶃ:"g",ǥ:"g",ḫ:"h",ȟ:"h",ḩ:"h",ĥ:"h",ⱨ:"h",ḧ:"h",ḣ:"h",ḥ:"h",ɦ:"h",ẖ:"h",ħ:"h",ƕ:"hv",í:"i",ĭ:"i",ǐ:"i",î:"i",ï:"i",ḯ:"i",ị:"i",ȉ:"i",ì:"i",ỉ:"i",ȋ:"i",ī:"i",į:"i",ᶖ:"i",ɨ:"i",ĩ:"i",ḭ:"i",ꝺ:"d",ꝼ:"f",ᵹ:"g",ꞃ:"r",ꞅ:"s",ꞇ:"t",ꝭ:"is",ǰ:"j",ĵ:"j",ʝ:"j",ɉ:"j",ḱ:"k",ǩ:"k",ķ:"k",ⱪ:"k",ꝃ:"k",ḳ:"k",ƙ:"k",ḵ:"k",ᶄ:"k",ꝁ:"k",ꝅ:"k",ĺ:"l",ƚ:"l",ɬ:"l",ľ:"l",ļ:"l",ḽ:"l",ȴ:"l",ḷ:"l",ḹ:"l",ⱡ:"l",ꝉ:"l",ḻ:"l",ŀ:"l",ɫ:"l",ᶅ:"l",ɭ:"l",ł:"l",ǉ:"lj",ſ:"s",ẜ:"s",ẛ:"s",ẝ:"s",ḿ:"m",ṁ:"m",ṃ:"m",ɱ:"m",ᵯ:"m",ᶆ:"m",ń:"n",ň:"n",ņ:"n",ṋ:"n",ȵ:"n",ṅ:"n",ṇ:"n",ǹ:"n",ɲ:"n",ṉ:"n",ƞ:"n",ᵰ:"n",ᶇ:"n",ɳ:"n",ñ:"n",ǌ:"nj",ó:"o",ŏ:"o",ǒ:"o",ô:"o",ố:"o",ộ:"o",ồ:"o",ổ:"o",ỗ:"o",ö:"o",ȫ:"o",ȯ:"o",ȱ:"o",ọ:"o",ő:"o",ȍ:"o",ò:"o",ỏ:"o",ơ:"o",ớ:"o",ợ:"o",ờ:"o",ở:"o",ỡ:"o",ȏ:"o",ꝋ:"o",ꝍ:"o",ⱺ:"o",ō:"o",ṓ:"o",ṑ:"o",ǫ:"o",ǭ:"o",ø:"o",ǿ:"o",õ:"o",ṍ:"o",ṏ:"o",ȭ:"o",ƣ:"oi",ꝏ:"oo",ɛ:"e",ᶓ:"e",ɔ:"o",ᶗ:"o",ȣ:"ou",ṕ:"p",ṗ:"p",ꝓ:"p",ƥ:"p",ᵱ:"p",ᶈ:"p",ꝕ:"p",ᵽ:"p",ꝑ:"p",ꝙ:"q",ʠ:"q",ɋ:"q",ꝗ:"q",ŕ:"r",ř:"r",ŗ:"r",ṙ:"r",ṛ:"r",ṝ:"r",ȑ:"r",ɾ:"r",ᵳ:"r",ȓ:"r",ṟ:"r",ɼ:"r",ᵲ:"r",ᶉ:"r",ɍ:"r",ɽ:"r",ↄ:"c",ꜿ:"c",ɘ:"e",ɿ:"r",ś:"s",ṥ:"s",š:"s",ṧ:"s",ş:"s",ŝ:"s",ș:"s",ṡ:"s",ṣ:"s",ṩ:"s",ʂ:"s",ᵴ:"s",ᶊ:"s",ȿ:"s",ɡ:"g",ᴑ:"o",ᴓ:"o",ᴝ:"u",ť:"t",ţ:"t",ṱ:"t",ț:"t",ȶ:"t",ẗ:"t",ⱦ:"t",ṫ:"t",ṭ:"t",ƭ:"t",ṯ:"t",ᵵ:"t",ƫ:"t",ʈ:"t",ŧ:"t",ᵺ:"th",ɐ:"a",ᴂ:"ae",ǝ:"e",ᵷ:"g",ɥ:"h",ʮ:"h",ʯ:"h",ᴉ:"i",ʞ:"k",ꞁ:"l",ɯ:"m",ɰ:"m",ᴔ:"oe",ɹ:"r",ɻ:"r",ɺ:"r",ⱹ:"r",ʇ:"t",ʌ:"v",ʍ:"w",ʎ:"y",ꜩ:"tz",ú:"u",ŭ:"u",ǔ:"u",û:"u",ṷ:"u",ü:"u",ǘ:"u",ǚ:"u",ǜ:"u",ǖ:"u",ṳ:"u",ụ:"u",ű:"u",ȕ:"u",ù:"u",ủ:"u",ư:"u",ứ:"u",ự:"u",ừ:"u",ử:"u",ữ:"u",ȗ:"u",ū:"u",ṻ:"u",ų:"u",ᶙ:"u",ů:"u",ũ:"u",ṹ:"u",ṵ:"u",ᵫ:"ue",ꝸ:"um",ⱴ:"v",ꝟ:"v",ṿ:"v",ʋ:"v",ᶌ:"v",ⱱ:"v",ṽ:"v",ꝡ:"vy",ẃ:"w",ŵ:"w",ẅ:"w",ẇ:"w",ẉ:"w",ẁ:"w",ⱳ:"w",ẘ:"w",ẍ:"x",ẋ:"x",ᶍ:"x",ý:"y",ŷ:"y",ÿ:"y",ẏ:"y",ỵ:"y",ỳ:"y",ƴ:"y",ỷ:"y",ỿ:"y",ȳ:"y",ẙ:"y",ɏ:"y",ỹ:"y",ź:"z",ž:"z",ẑ:"z",ʑ:"z",ⱬ:"z",ż:"z",ẓ:"z",ȥ:"z",ẕ:"z",ᵶ:"z",ᶎ:"z",ʐ:"z",ƶ:"z",ɀ:"z",ﬀ:"ff",ﬃ:"ffi",ﬄ:"ffl",ﬁ:"fi",ﬂ:"fl",ĳ:"ij",œ:"oe",ﬆ:"st",ₐ:"a",ₑ:"e",ᵢ:"i",ⱼ:"j",ₒ:"o",ᵣ:"r",ᵤ:"u",ᵥ:"v",ₓ:"x"};if(!e.normalize)return e;const n=e.replace(/[^A-Za-z0-9[\] ]/g,(function(e){return t[e]||e}));return e.normalize("NFC").length==n.normalize("NFC").length?n:""},escapeRegExp:e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),match(e,t,n){const r=new RegExp(t,n?"g":"gi"),o=[];let i=r.exec(e);for(;null!=i;)o.push([i.index,i[0].length]),i=r.exec(e);return o},exec:(e,t)=>new RegExp(e).exec(t)}}function J(e){const t=new FileReader;return new Promise(((n,r)=>{t.onerror=e=>{r(new Error(e))},t.onload=e=>{n(new Uint8Array(e.target?.result))},t.readAsArrayBuffer(e)}))}const R="text",U="documentA",L="documentB",z="result",W="Maui_Android",V="Maui_iOS",q="Maui_MacCatalyst",K="Maui_Windows",G="FlutterForWeb",Z="Electron",H="cms",Y="unableToShape",X="requiresMoreFonts";async function Q(e){try{const n=await fetch(e).catch((n=>{throw new t(`Error fetching dynamic fonts file ${e}. ${n}`)}));if(200!==n.status)throw new t(`Error fetching dynamic fonts file ${e}. Status code: ${n.status}`);return n}catch(e){throw e}}function ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis.navigator?.userAgent??"";return e.indexOf("Trident/")>-1?"trident":e.indexOf("Edge/")>-1?"edge":e.indexOf("Chrome/")>-1?"blink":e.indexOf("AppleWebKit/")>-1?"webkit":e.indexOf("Gecko/")>-1?"gecko":"unknown"}function te(e,t){const n=new RegExp(` ${t}/(\\d+)\\.*`);let r;return(r=e.match(n))?Number(r[1]):0}function ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis.navigator?.userAgent??"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis.navigator?.platform??"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:globalThis.navigator?.maxTouchPoints??0;return t.indexOf("MacIntel")>-1&&n>1?"ios":e.indexOf("Win")>-1?"windows":e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1||"iPad"===t?"ios":e.indexOf("Mac")>-1?"macos":e.indexOf("Android")>-1?"android":e.indexOf("Linux")>-1?"linux":"unknown"}ee();const re=ne(),oe=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis.navigator?.userAgent;switch(ee(e)){case"trident":return te(e,"Trident");case"edge":return te(e,"Edge");case"blink":return te(e,"Chrome");case"webkit":return te(e,"Version");case"gecko":return te(e,"Firefox");default:;}}(),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee();"ios"===e||"android"===e||ie(t)}(),"ios"===re||ie(),"ios"===re);function ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee();return("undefined"==typeof window||!window.PSPDFKIT_PLAYWRIGHT_TEST)&&("webkit"===e&&"undefined"!=typeof TouchEvent)}let ae;"undefined"!=typeof window&&(window.addEventListener("mousemove",(function e(){ae=!1,window.removeEventListener("mousemove",e)})),window.addEventListener("pointermove",(function e(t){"mouse"!==t.pointerType&&"pen"!==t.pointerType||(ae=!1),window.removeEventListener("pointermove",e)})));/Mac/i.test(globalThis.navigator?.platform);function se(){return"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron/")>=0}const ce="/create.pdf",ue="/save.pdf",le="/embedded.pdf",de="WebAssembly module not loaded.";let pe=null,fe=!1,me=!1,ge=null,he=[],ye=null,be=null,we=null;const ve=new Set,_e="/fonts";let Oe;const Se=new Set;let Fe=!1;var xe=function(e){return e[e.Daemon=0]="Daemon",e[e.WASM=1]="WASM",e}(xe||{});const Ie=[];function Ee(e){return null!=e&&null!=e.length&&0===e.length}const je=["configurePDFJavaScriptSupport","closeDocument","setFormValues","openDocument","saveDocument","importXFDF","importInstantDocumentJSON"],Ae={annotationsAndForms:"annotations_and_forms",assemble:"assemble",extract:"extract",extractAccessibility:"extract_accessibility",fillForms:"fill_forms",modification:"modification",printHighQuality:"print_high_quality",printing:"printing"};function De(e){let t;o(pe,"WebAssembly module not loaded."),Fe&&(t=performance.now());for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const a=r.map((e=>Ee(e)?JSON.stringify(e):e));je.includes(e)&&Le();const s=pe[e](...a)||'{ "success": true }',c=JSON.parse(s);if(Fe&&Ie.push({type:xe.WASM,name:e,args:a,time:performance.now()-t}),!c.success)throw new Error(c.error);return c}function Pe(e){let t;o(pe,"WebAssembly module not loaded."),Fe&&(t=performance.now());for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];je.includes(e)&&Le();const a=r.map((e=>Ee(e)?JSON.stringify(e):e)),s=pe[e](...a);return Fe&&Ie.push({type:xe.WASM,name:e,args:a,time:performance.now()-t}),s}const ke=["run_pdf_formatting_scripts","run_pdf_javascript","set_form_values_get_script_changes","edit_document","prepare_sign","sign","on_keystroke_event","save_document","update_annotation"];function Te(e){const t=new ArrayBuffer(2*e.length),n=new Uint16Array(t);for(let t=0,r=e.length;t<r;t++)n[t]=e.charCodeAt(t);return t}function Ce(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(pe,"WebAssembly module not loaded.");const r=JSON.stringify({type:e,...t});let i,a;if(Fe&&(i=performance.now()),ke.includes(e)&&Le(),n)try{const e="string"==typeof n?new Uint8Array(Te(n)):new Uint8Array(n),t=pe.allocateMemory(e.byteLength);try{t.view.set(e);const n=pe.memoryHandleToVector(t);try{a=pe.dispatchCommandWithBinary(r,n)}finally{n.delete()}}finally{t.delete()}}catch(e){throw e}else a=pe.dispatchCommand(r);if(a.hasError()){const t=new Error(a.getErrorMessage()||"There was an error while executing the command: "+e);throw a.delete(),t}const s=[];for(let e=0;e<a.getRepliesCount();e++)a.hasJSONReply(e)&&s.push(JSON.parse(a.getJSONReply(e))),a.hasBinaryReply(e)&&s.push(a.getBinaryReply(e).slice(0));return Fe&&Ie.push({type:xe.Daemon,name:e,args:[r],time:performance.now()-i}),a.delete(),s}function Ne(e,t){return`${e}/${t}.pdf`}async function Be(e,t){const n=Math.random().toString(36).slice(-5),r=await Promise.all(Object.entries(t).map((async t=>{let[r,o]=t;return e.forEach((e=>{"document"in e&&e.document===r&&"importDocument"===e.type?(!1===e.treatImportedDocumentAsOnePage&&(e.treatImportedDocumentAsOnePage=void 0),e.document=Ne(n,r)):("dataFilePath"in e&&e.dataFilePath===r&&"applyInstantJson"===e.type||"dataFilePath"in e&&e.dataFilePath===r&&"applyXfdf"===e.type)&&(e.dataFilePath=Ne(n,r))})),{basename:r,buffer:await J(o)}})));return r.forEach((e=>{!function(e,t,n){o(pe,de),pe.FS.analyzePath(e).exists||pe.FS.mkdir(e),pe.FS.writeFile(Ne(e,t),n)}(n,e.basename,e.buffer)})),function(){r.forEach((e=>{!function(e,t){o(pe,de),pe.FS.unlink(Ne(e,t))}(n,e.basename)}))}}function $e(){me=!0;const e=De("configurePDFJavaScriptSupport",!0);return o(e.success,"An error occurred while executing the document level JavaScript."),e.changes||[]}function Me(e,t){let n;try{n=Ce("edit_document",{save_path:t,operations:e})}catch(e){throw new Error(`Error applying operations to document: ${e.message}`)}return n}let Je,Re=null,Ue=!1;function Le(){Ue||(Re=null,Je=!1)}function ze(e){Ue&&!e&&(Ue=!1,Re&&Ve(Re)),Ue=e}function We(){return null===Re&&(Re=Ce("read_form_json_objects",{include_line_height_factor:!1}),Je=!1),Re}function Ve(e){if(Ue){if(null===e)throw Ue=!1,new Error("Error enqueuing form JSON objects: form fields JSON is null.");return Re&&!Je&&(Je=!0),void(Re=e)}if(Je||!Ue)try{Le(),Ce("apply_form_json_objects",{form_fields_with_widgets:e})}catch(e){throw new Error("Error applying form JSON objects to /create.pdf: "+e.message)}}function qe(e,t,n,r,i,a){const s=Ge(i,{width:n,height:r});if(o("number"==typeof e.pageIndex,"Annotation must have a pageIndex"),!ve.has(e.pdfObjectId))try{o("number"==typeof e.pdfObjectId,"Cannot call renderAnnotation() for an annotation without pdfObjectId.");const t=Ce("render_annotation",{page:e.pageIndex,annotation_id:e.pdfObjectId,format:s,bitmap_width:n,bitmap_height:r,appearance_stream_type:a||"normal"});if("bitmap"===s)return t[0];{const e=new Blob([t[0]],{type:`image/${s}`});return URL.createObjectURL(e)}}catch(e){return void 0}}const Ke={SharePoint:"SPO",Salesforce:"SF",[V]:"MauiIOS",[W]:"MauiAndroid",[q]:"MauiMacCatalyst",[K]:"MauiWindows",[G]:"FlutterForWeb",NodeJS:"NodeJS",Electron:"Electron"};function Ge(e,t){let{width:n,height:r}=t;return"webp"===e&&(n>16383||r>16383)||oe&&n*r>16777216&&"bitmap"===e?"png":e}function Ze(e){const t=[];for(let n=0;n<e.length;n++)t.push(Ae[e[n]]);return t}function He(e,t){return e.pdfObjectId===t.pdfObjectId}const Ye=new class{constructor(){l(this,"_pdfObjectIdsForIds",{}),l(this,"comparisonDocuments",{}),l(this,"lastOpenedComparisonDocument",null),l(this,"persistedOpenDocument",null)}loadNativeModule(e,t){let{disableWebAssemblyStreaming:n,enableAutomaticLinkExtraction:r,overrideMemoryLimit:o}=t;return be=Date.now(),fe=r,ge=o,function(e,t){let n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:globalThis;return new Promise((async a=>{n=$(e,t),"string"==typeof e&&(r=await T(`${e}${N}`)),i("Using WASM method"),M(o),a({nativeModule:await r(n)})}))}(e,n).then((e=>{let{nativeModule:t}=e;pe=t;const n=De("PSPDFKitVersion").version;if(1!==n)throw new Error(`Native version mismatch. Please update the dependencies. Expected 1 but got ${n}.`)}))}corePBProtoBridge(e,t,n){const r=pe.allocateMemory(n.byteLength);let o;try{r.view.set(n),o=pe.corePBProtoBridge(e,t,r);const i={success:o.success,result:o.result.view.slice()};return Promise.resolve(i)}finally{r.delete(),o&&o.result&&o.result.delete()}}async writeFile(e,t){o(pe,de),pe.FS.writeFile(e,new Uint8Array(t))}async readFile(e){return o(pe,de),pe.FS.readFile(e)}async load(e,t,n){let r,{mainThreadOrigin:a,customFonts:s,dynamicFonts:c,productId:u}=n;o(pe,de);try{if(pe.FS.analyzePath(_e).exists||pe.FS.mkdir(_e),Oe=s?"/fonts/custom-fonts":"",s&&!pe.FS.analyzePath(Oe).exists&&function(e,t){o(pe,de),pe.FS.analyzePath(t).exists||pe.FS.mkdir(t),pe.FS.mount(pe.FS.filesystems.WORKERFS,{blobs:e},t)}(s,Oe),se()&&(o(null==u||u===Z,`PSPDFKit is running on Electron, but has been setup to be used with ${u}Please contact support to resolve the issue.`),u=Z),r=pe.initPSPDFKit(null==t?"":t,a,_e,"",u&&void 0!==Ke[u]?Ke[u]:""),c){const e=await Q(c);Ce("dynamic_font_loading/set_metadata_file",void 0,await e.arrayBuffer()),we=c.split("/").slice(0,-1).join("/")}}catch(e){throw e}const l=JSON.parse(r);if(be&&i(`Native initialization complete, took: ${Date.now()-be}ms`),!l.success)throw new Error("Failed to initialize PSPDFKit: "+l.error);return l}getNativeModule(){return pe}async openDocument(e,t,n){try{return o(pe,de),null!==ge&&De("overrideMemoryLimit",ge),ye=t,pe.FS.writeFile(ce,new Uint8Array(e)),this.openAndReturnDocumentInfo(n)}finally{this._pdfObjectIdsForIds={}}}async getSuggestedLineHeightFactor(e,t){return Ce("get_suggested_line_height_factor",{annotation_ids:[e],page:t})[0].line_height_factors[e.toString()]}async getAvailableFontFaces(e){if(!e)return[];return Ce("get_available_font_faces")[0]?.font_faces.reduce(((t,n)=>{const r=e.find((e=>e.name===n.path.replace(`${Oe}/`,"")));return r?t.concat({readableName:n.fullName,name:r.name}):t}),[])}async setFontSubstitutions(e){try{Ce("set_font_substitutions",{substitutions:e})}catch(e){throw new Error("Error setting fonts substitutions: "+e.message)}}async getClosestSnapPoint(e,t){return Ce("get_closest_snap",{q:[e,t]})[0]}async configureSnapper(e){Ce("configure_snapper",{page:e})}async reloadDocument(){try{return ze(!1),De("closeDocument"),this.openAndReturnDocumentInfo()}finally{this._pdfObjectIdsForIds={}}}async openAndReturnDocumentInfo(e){De("openDocument",ce,JSON.stringify({password:ye})),me&&$e(),De("automaticLinkExtraction",fe);const t=De("getDocumentInfo").documentInfo;if(t.pageCount<=0)return t;let n=[];if("number"==typeof e){const r=await this.getPageInfo(e);for(let o=0;o<t.pageCount;o++){const t={...r,pageIndex:o,pageLabel:e===o?r.pageLabel:String(o+1)};n.push(t)}}else n=await this.getAllPageInfos(t.pageCount);return t.pages=n,t}async getPageInfo(e){try{const t=Ce("page_info",{query:"page_info",page:e});o(1===t.length,"expected page_info result to return 1 result when specifying index.");const n=(new TextDecoder).decode(t[0]);return JSON.parse(n).pageInfo}catch(t){return s(`Dimensional information for page ${e} unavailable, page will not be displayed.`),{height:0,matrix:[0,0,0,0,0,0],pageLabel:"",reverseMatrix:[0,0,0,0,0,0],transformedBBox:[0,0,0,0],untransformedBBox:[0,0,0,0],width:0,pageIndex:e,rawPdfBoxes:{bleedBox:null,cropBox:null,mediaBox:null,trimBox:null}}}}async preflightRenderAnnotationText(e,t,n,r){const i=()=>"number"==typeof t&&"number"==typeof n?Ce("dynamic_font_loading/preflight_annotation",{text:e,annotation_id:t,page:n})[0]:(o(r,`annotation not set: ${r}`),Ce("dynamic_font_loading/preflight_annotation",{text:e,annotation_json:r})[0]);try{let e=i();e.preflight_result===X&&(await this.addDynamicFonts(e.required_fonts),e=i()),"number"==typeof t&&(e.preflight_result===Y?ve.add(t):ve.delete(t))}catch(n){s(`There was an error testing rendering for annotation ${t} of this text: ${e}: ${n.message}`)}}async addDynamicFonts(e){let t=[];try{t=e.filter((e=>!Se.has(e)));!function(e){o(pe,de),e.forEach((e=>{pe.FS.analyzePath(`/fonts/${e.name}`).exists||pe.FS.writeFile(`/fonts/${e.name}`,new Uint8Array(e.data))}))}((await Promise.all(t.map((e=>fetch(`${we}/${e}`).then((e=>e.arrayBuffer())))))).map(((e,n)=>({name:t[n],data:e})))),t.forEach((e=>{Se.add(e)}))}catch(e){t.forEach((e=>{Se.delete(e)})),s(`There was an error loading a font: ${e}`)}await Ce("dynamic_font_loading/notify_fonts_added",{added_fonts:t.map((e=>({remote_file_path:e,local_file_name:e})))})}async getAllPageInfos(e){const t=[];try{const n=Ce("page_info",{query:"page_info",page:"all"});o(n.length===e,"expected the same length of page info response to page count.");for(let e=0;e<n.length;e++){const r=(new TextDecoder).decode(n[e]),o=JSON.parse(r);t.push(o.pageInfo)}}catch(n){s("There was an error retrieving page information for all pages from core. Reverting to individual queries.");for(let n=0;n<e;n++)try{const e=Ce("page_info",{query:"page_info",page:n});o(1===e.length,"expected page_info result to return 1 result when specifying index.");const r=(new TextDecoder).decode(e[0]),i=JSON.parse(r);t.push(i.pageInfo)}catch(e){s(`Dimensional information for page ${n} unavailable, page will not be displayed.`);const r={height:0,matrix:[0,0,0,0,0,0],pageLabel:"",reverseMatrix:[0,0,0,0,0,0],transformedBBox:[0,0,0,0],untransformedBBox:[0,0,0,0],width:0,pageIndex:n,rawPdfBoxes:{bleedBox:null,cropBox:null,mediaBox:null,trimBox:null}};t.push(r)}}return t}async enablePDFJavaScriptSupport(){return $e()}async runPDFFormattingScripts(e,t){let n;o(me,"PDF Formatting Scripts can only run after JavaScript is enabled.");try{n=Ce("run_pdf_formatting_scripts",{form_fqns:e,only_if_no_ap_stream:t})}catch(e){throw new Error("An error occurred while executing the document level JavaScript formatting.\n\n"+e.message)}return n[0].changes||[]}async openDocumentAt(){throw new Error("Should never be called")}async getBookmarks(){const e=Ce("get_bookmarks");return o(1===e.length,"expected only one response for getBookmarks"),e[0].bookmarks||[]}async getFormJSON(){return De("getFormJSON").formJSON}async getFormValues(){return De("getFormValues").formValues}async setFormValues(e){const t=We();let n=!1;const r=[],o=t.map((t=>{const o=e.find((e=>e.name===t.formField.name));return o?o.value===t.value||Array.isArray(o.value)&&Array.isArray(t.value)&&o.value.every(((e,n)=>e===t.value[n]))?t:("string"==typeof o.value&&o.value.length>0?r.push({widgets:t.widgets,text:o.value}):t.widgets.forEach((e=>{"number"==typeof e.pdfObjectId&&ve.delete(e.pdfObjectId)})),n=!0,{...t,value:o.value}):t}));if(n){if(we)for(let e=0;e<r.length;e++){const t=r[e].widgets;for(let n=0;n<t.length;n++)await this.preflightWidgetAnnotation(t[n],t[n].pdfObjectId,r[e].text)}Ve(o)}}async setFormFieldValue(e){await this.setFormValues([e])}async applyOperations(e,t){const n=await Be(e,t);Me(e,ce),n()}async exportPDFWithOperations(e,t){const n=await Be(e,t);let r;o(pe,de);try{Me(e,ue),r=pe.FS.readFile(ue).buffer}catch(e){throw new Error("Error applying operations: "+e.message)}return n(),r}async getSignaturesInfo(){try{return Ce("get_signatures",{certificate_check_time:"current_time"})[0]}catch(e){throw new Error(`Error getting signatures info: ${e.message}`)}}async getComments(){try{return Ce("get_comments")}catch(e){throw new Error(`Error getting comments: ${e.message}`)}}async applyComments(e){try{return Ce("apply_comments",{comments:e})}catch(e){throw new Error(`Error applying comments: ${e.message}`)}}async prepareSign(e,t,n,r,i,a){let s;try{s=Ce("get_signatures",{certificate_check_time:"current_time"})[0];const e="not_signed"!==s.status;De("saveDocument",ue,!1,e,false,false,"pdf",!1),De("openDocument",ue,JSON.stringify({password:ye}))}catch(e){throw new Error(`Error saving document backup for invisible signing: ${e}`)}try{const e=!n&&"not_signed"!==s.status;De("saveDocument",ce,n,e,false,false,"pdf",!1),n&&(De("openDocument",ce,JSON.stringify({password:ye})),me&&$e())}catch(e){throw new Error(`Error saving document for invisible signing: ${e}`)}let c;try{c=Ce("prepare_sign",{signer_data_source:{...e,field_name:r,position:i,appearance:a,type:"pspdfkit/signer-data-source"},signature_metadata:{...t,type:"pspdfkit/signature-metadata"}})}catch(e){throw new Error(`Error preparing document for signing: ${e}`)}o(pe,de);let u=null;return e&&e?.signatureType!==H||(u=pe.FS.readFile(c[0].result.file_contents).buffer),pe.FS.unlink(c[0].result.file_contents),{file:c[0].result.file,hash:c[0].result.hash,signatureFormFieldName:c[0].result.signature_form_fqn,dataToBeSigned:c[0].result.data_to_be_signed,fileContents:u}}async getTimestampRequest(e,t){try{const[n]=Ce("get_timestamp_http_request",{timestamp_authority_info:{url:t.url,authenticationInfo:{username:t.username,password:t.password}},data_to_timestamp:e});return{url:n.url,method:n.method,requestData:n.request_data,contentType:n.content_type,token:n.token,username:n.user,password:n.password}}catch(e){throw new Error(`Error getting timestamp request: ${e.message}`)}}async getRevocationRequests(e){try{return Ce("get_revocation_http_requests",{signing_certificates:e})}catch(e){throw new Error(`Error getting revocations requests: ${e.message}`)}}async setSignaturesLTV(e){try{const t=Ce("get_signatures",{certificate_check_time:"current_time",revocation_responses:e})[0];return De("saveDocument",ce,!1,!0,!1,!1,"pdf",!1),t}catch(e){throw new Error(`Error getting signatures info: ${e.message}`)}}async sign(e,t,n,r,o,i,a,s,c){let u;try{let l;const d=F(o).buffer,p=a?"pkcs7"===a:function(e){try{const t=new Uint8Array(e);return!!t.length&&48===t[0]}catch(e){throw new Error(`Error checking if the signature is in PKCS#7 format: ${e.message}`)}}(d);p||(l=Ce("create_signature",{signatureType:r,hash:n,signed_data:o,certificates:i,timestamp_response:s})),u=Ce("sign",{password:ye,save_path:ce,file_path:e,signature_form_fqn:t,pkcs7_container:l?.[0].result||o,revocation_responses:c??[]}),De("openDocument",ce,JSON.stringify({password:ye})),me&&$e()}catch(e){throw new Error(`Error signing document: ${e}`)}return u[0].result}async restoreToOriginalState(){try{De("openDocument",ue,JSON.stringify({password:ye})),me&&$e();const e="not_signed"!==Ce("get_signatures",{certificate_check_time:"current_time"})[0].status;De("saveDocument",ce,!1,e,!1,!1,"pdf",!1),De("openDocument",ce,JSON.stringify({password:ye})),me&&$e()}catch(e){throw new Error(`Could not restore backup document: ${e}`)}}async evalFormValuesActions(e){const t=We().reduce(((t,n)=>e.find((e=>{let{name:t}=e;return n.formField.name===t}))&&"pspdfkit/form-field/text"===n.formField.type?t.concat(n):t),[]);if(we)for(let n=0;n<t.length;n++){const r=t[n].widgets;for(let n=0;n<r.length;n++)await this.preflightWidgetAnnotation(r[n],r[n].pdfObjectId,e.find((e=>t[n].formField.name===e.name))?.value)}const n=Ce("set_form_values_get_script_changes",{form_values:e});return o(1===n.length,"expected only one response for evalFormValuesActions"),this._processChanges(n[0].changes)}async readFormJSONObjects(){return We()}async setFormJSONUpdateBatchMode(e){await ze(e)}_processChanges(e){return e.map((e=>"pspdfkit/javascript/effects/importIcon"===e.object.type?{...e,object:{...e.object,id:Object.entries(this._pdfObjectIdsForIds).find((t=>{let[,n]=t;return n===e.object.annotationID}))?.[0]}}:e))}async evalScript(e,t,n){const r=Ce("run_pdf_javascript",{pdf_javascript_contents:e,pdf_javascript_trigger_event:t,pdf_javascript_form_fqn:n});return o(1===r.length,"expected only one response for evalScript"),this._processChanges(r[0].changes)}async closeDocument(){try{return he=[],ye=null,me=!1,Re=null,Ue=!1,Je=!1,De("closeDocument")}finally{this._pdfObjectIdsForIds={}}}async renderAnnotation(e,t,n,r,o,i){return qe({...e,pdfObjectId:this._getPdfObjectIdForObject(e)},t&&await J(t),n,r,o,i)}async renderPageAnnotations(e,t,n,r,o){return t.map(((t,i)=>qe({pdfObjectId:t,pageIndex:e},0,n[i],r[i],Ge(o,{width:n[i],height:r[i]}))))}async renderDetachedAnnotation(e,t,n,r,i){o(pe,de),!we||"pspdfkit/stamp"!==e.type&&"pspdfkit/text"!==e.type||await this.preflightAnnotation(e,e.pdfObjectId);const a=t?await J(t):null,s=t?t.type:null;let c,u;const l=new pe.VectorUint8;try{if(null!=a)for(let e=0;e<a.byteLength;e++)l.push_back(a[e]);if(u=Pe("renderDetachedAnnotation",i,JSON.stringify({...e,pdfObjectId:this._getPdfObjectIdForObject(e),pageIndex:0}),0,n,r,l,s||""),u.hasError()||1!==u.getRepliesCount()){const e=u.getErrorMessage(),t=u.getErrorReason();throw new Error(t+": "+e)}c=u.getBinaryReply(0).slice(0)}finally{l&&l.delete(),u&&u.delete()}return c}async loadCertificates(e){if(Ce("load_certificates",{certificates:e}).length>0)throw new t("Internal error while loading certificates")}async getAttachment(e){let t,n,r;const o=(await this.getEmbeddedFilesList())?.map((e=>e.id)),i=o?.includes(e);try{if(i)Ce("extract_embedded_file",{id:e,file_path:le}),t=pe.FS.readFile(le).buffer;else{if(n=Pe("getAnnotationAttachment",e),n.hasError()||1!==n.getRepliesCount()){const e=n.getErrorMessage(),t=n.getErrorReason();throw new Error("Error fetching attachment: "+t+", "+e)}r=JSON.parse(n.getJSONReply(0)).encoding,t=n.getBinaryReply(0).slice(0)}}finally{pe.FS.analyzePath(le)?.exists&&pe.FS.unlink(le),n&&n.delete()}return[t,r]}async annotationsForPageIndex(e){const t=De("annotationsForPageIndex",e);return["rollover","down"].forEach((e=>{t.apstream_variants?.[e]?.forEach((n=>{const r=t.annotations.find((e=>e.pdfObjectId===n));r?r[e]=!0:t.annotations.push({pdfObjectId:n,[e]:!0})}))})),t.annotations}async getTabOrder(e){return Ce("get_annotation_tab_order",{page:e})[0].order.map((e=>({id:Object.entries(this._pdfObjectIdsForIds).find((t=>{let[n,r]=t;return r===e}))?.[0]||String(e),pdfObjectId:e})))}async setTabOrder(e,t){Ce("set_annotation_tab_order",{page:e,order:t.map((e=>this._getPdfObjectIdForObject(e)))})}async createAnnotation(e,t){o(pe,de),o("number"==typeof e.pageIndex,"Annotation must have a pageIndex");const n=e.pdfObjectId,r=t?await J(t):null;let i;const a=new pe.VectorUint8;try{if(null!=r)for(let e=0;e<r.byteLength;e++)a.push_back(r[e]);"pspdfkit/widget"===e.type&&(ze(!1),Le());const t=("pspdfkit/shape/ellipse"===e.type||"pspdfkit/shape/rectangle"===e.type)&&e.measurementScale?{...e,measurementBBox:e.bbox}:e;i=De("createAnnotation",JSON.stringify({...t,pdfObjectId:null}),a)}finally{a&&a.delete()}return"number"==typeof n&&"number"==typeof this._pdfObjectIdsForIds[n.toString()]&&delete this._pdfObjectIdsForIds[n.toString()],this._pdfObjectIdsForIds[e.id||i.pdfObjectId.toString()]=i.pdfObjectId,e&&this.canPreflightAnnotation(e)&&we&&await this.preflightAnnotation(e,i.pdfObjectId),i.pdfObjectId}async updateAnnotation(e){const t={...e,pdfObjectId:this._getPdfObjectIdForObject(e)};if(o(t.id,"Annotation must have an ID"),o("number"==typeof t.pageIndex,"Annotation must have a pageIndex"),"pspdfkit/widget"===t.type){const e=We(),n="number"==typeof t.pdfObjectId?t.pdfObjectId.toString():t.id;Ve(e.map((e=>e.formField.annotationIds.includes(n)||e.formField.annotationIds.includes(String(t.pdfObjectId))?{...e,widgets:e.widgets.map((e=>e.id===n||String(e.pdfObjectId)===n?t:e))}:e)))}else e&&this.canPreflightAnnotation(e)&&we&&await this.preflightAnnotation(e,t.pdfObjectId),De("updateAnnotation",JSON.stringify(t),0,0)}async updateButtonIcon(e,t,n){Ce("update_annotation",{annotation:{...e,pdfObjectId:this._getPdfObjectIdForObject(e),contentType:n}},t)}async deleteAnnotation(e){if(e.APStreamCache&&await this.updateAnnotation(e),"pspdfkit/widget"===e.type)try{const t=e.id;Ve(We().map((n=>{if(n.formField.annotationIds.includes(t)||n.formField.annotationIds.includes(String(e.pdfObjectId))){let r,o=n.value;if(("pspdfkit/form-field/checkbox"===n.formField.type||"pspdfkit/form-field/radio"===n.formField.type)&&n.formField.options.length===n.formField.annotationIds.length){const i=n.formField.annotationIds.includes(t)?n.formField.annotationIds.indexOf(t):n.formField.annotationIds.indexOf(String(e.pdfObjectId));r=n.formField.options.filter(((e,t)=>t!==i)),r.some((e=>e.value===o))||(o="")}const i=n.widgets.filter((e=>t!==e.id)),a=n.formField.annotationIds.filter((n=>n!==t&&n!==String(e.pdfObjectId)));return i.length>0&&a.length>0?{...n,formField:{...n.formField,annotationIds:a,...r?{options:r}:null},widgets:i,value:o}:null}return n})).filter(Boolean))}catch(e){throw e}else try{Ce("remove_annotations",{annotation_ids:[this._getPdfObjectIdForObject(e)]})}catch(t){a(`Removing annotation failed for annotation: ${JSON.stringify(e)}`)}delete this._pdfObjectIdsForIds[e.id||e.pdfObjectId?.toString()],ve.delete(e.pdfObjectId)}async createFormField(e,t){const n=We().concat([{type:"pspdfkit/form-field-with-widgets",formField:e,widgets:t}]),r=Ue;Ue&&ze(!1),Ve(n);const o=We();r&&ze(!0);const i=o.find((t=>t.formField.name===e.name));if(!i)throw new Error(`Error creating new form field in /create.pdf: created form field not found. ${JSON.stringify({type:"pspdfkit/form-field-with-widgets",formField:e,widgets:t})}`);const a=i.widgets.map((e=>(this._pdfObjectIdsForIds[e.id]=e.pdfObjectId,e.pdfObjectId)));return"number"==typeof e.pdfObjectId&&"number"==typeof this._pdfObjectIdsForIds[e.pdfObjectId.toString()]&&delete this._pdfObjectIdsForIds[e.pdfObjectId.toString()],this._pdfObjectIdsForIds[e.id||i.formField.pdfObjectId.toString()]=i.formField.pdfObjectId,a}async updateFormField(e,t){let n={...e,pdfObjectId:this._pdfObjectIdsForIds[e.id]||this._getPdfObjectIdForObject(e)};const r=We(),o=r.find((t=>He(t.formField,n)||t.formField.name===e.name));if(!o)throw new Error(`Error updating form field with name "${e.name}" in /create.pdf: form field not found. ${JSON.stringify(r)}`);const i=o.formField.name!==e.name;let a=null;if(i&&"pspdfkit/form-field/radio"===n.type){const o=e.name,i=r.find((e=>e.formField.name===o));i&&"pspdfkit/form-field/radio"===i.formField.type&&(n={...n,annotationIds:[...n.annotationIds,...i.formField.annotationIds],options:[...n.options,...i.formField.options]},t=[...t,...i.widgets],a=i)}Ve(r.map((r=>{if(a&&a.formField.pdfObjectId===r.formField.pdfObjectId)return null;if(He(r.formField,n)||r.formField.name===e.name){const o={type:"pspdfkit/form-field-with-widgets",formField:{...r.formField,...n},widgets:t.reduce(((e,t)=>[...e,{...r.widgets.find((e=>e.id===t.id||e.pdfObjectId===t.pdfObjectId)),...t}]),[]),...void 0!==r.value?{value:r.value}:null};return e.flags||delete o.formField.flags,o}return r})).filter(Boolean));const s=We().find((t=>t.formField.name===e.name));if(!s)throw new Error(`Error updating form field "${e.name}" in /create.pdf: updated form field not found. ${JSON.stringify({type:"pspdfkit/form-field-with-widgets",formField:e,widgets:t})}`);s.formField.pdfObjectId!==n.pdfObjectId&&(this._pdfObjectIdsForIds[n.id]=s.formField.pdfObjectId),o?.widgets.forEach((e=>{t.some((t=>t.id===e.id))||delete this._pdfObjectIdsForIds[e.id]}))}async deleteFormField(e){const t=We(),n=t.find((t=>t.formField.name===e.name));if(!n)return;Ve(t.filter((t=>t.formField.name!==e.name)));const r=We().find((t=>t.formField.name===e.name));if(r)throw new Error(`Error deleting form field with name "${e.name}" in /create.pdf: form field still present. ${JSON.stringify(r)}`);n.widgets.forEach((e=>{delete this._pdfObjectIdsForIds[e.id]}))}async deleteFormFieldValue(e){Ve(We().map((t=>t.formField.name===e?{formField:t.formField,widgets:t.widgets,type:t.type}:t)))}canPreflightAnnotation(e){return"pspdfkit/text"===e.type||"pspdfkit/stamp"===e.type}async preflightAnnotation(e,t){if(!this.canPreflightAnnotation(e))return;const n="pspdfkit/stamp"===e.type?e.title:e.text?.value;"number"!=typeof t||n?n&&await this.preflightRenderAnnotationText(n,t,e.pageIndex,{...e,pdfObjectId:this._getPdfObjectIdForObject(e),pageIndex:0}):ve.delete(t)}async preflightWidgetAnnotation(e,t,n){n||"number"!=typeof t?n&&await this.preflightRenderAnnotationText(n,t,e.pageIndex):ve.delete(t)}async createBookmark(e){try{Ce("append_bookmarks",{bookmarks:[e]})}catch(e){throw new Error(`Error creating new bookmark in /create.pdf: ${e.message}`)}}async updateBookmark(e){try{Ce("remove_bookmarks",{bookmarkIds:[e.id??e.pdfBookmarkId]}),Ce("append_bookmarks",{bookmarks:[e]})}catch(e){throw new Error(`Error updating bookmark in /create.pdf: ${e.message}`)}}async deleteBookmark(e){try{Ce("remove_bookmarks",{bookmarkIds:[e]})}catch(e){throw new Error(`Error deleting bookmark in /create.pdf: ${e.message}`)}}async getTextFromRects(e,t){return De("getTextFromRects",e,JSON.stringify(t.map((e=>[e.left,e.top,e.width,e.height])))).text}async search(e,t,n,r){return Ce("search",{query:e,start_index:t,limit:n,case_sensitive:r,search_type:arguments.length>4&&void 0!==arguments[4]?arguments[4]:R})}async parseXFDF(e,t){try{return function(e){try{const t=(new TextDecoder).decode(e);return JSON.parse(t)}catch(e){throw e}}(Ce("convert_xfdf_to_instant_json",{ignore_page_rotation:t},e)[0])}catch(e){throw e}}async getEmbeddedFilesList(){return Ce("list_embedded_files")[0].embeddedFiles||null}async getMeasurementSnappingPoints(e){const t=Ce("get_snapping_points",{page:e});return t[0].snappingPoints?function(e){const t=[...e.endpoints,...e.intersections,...e.midpoints],n=[];for(let e=0;e<t.length;e+=2){const r=[t[e],t[e+1]];n.push(r)}return n.sort(((e,t)=>e[0]==t[0]?e[1]-t[1]:e[0]-t[0]))}(t[0].snappingPoints):null}async getSecondaryMeasurementUnit(){try{return Ce("get_secondary_measurement_unit")[0]||null}catch(e){throw new Error(`Error getting secondary measurement: ${e.message}`)}}async compareDocuments(e){try{o(e.originalDocument.arrayBuffer,"Original document arrayBuffer is missing"),o(e.changedDocument.arrayBuffer,"Changed document arrayBuffer is missing"),pe.FS.writeFile("documentA.pdf",new Uint8Array(e.originalDocument.arrayBuffer)),pe.FS.writeFile("documentB.pdf",new Uint8Array(e.changedDocument.arrayBuffer));const t={originalDocument:{...e.originalDocument,filePath:"documentA.pdf"},changedDocument:{...e.changedDocument,filePath:"documentB.pdf"},comparisons:[e.comparisonOperation]};return Ce("document_comparison",t)||null}catch(e){throw new Error(`Error comparing documents: ${e.message}`)}}async setSecondaryMeasurementUnit(e){try{Ce("set_secondary_measurement_unit",e?{unitTo:e?.unitTo,precision:e?.precision}:null)}catch(e){a("Error setting secondary measurement unit")}}async getMeasurementScales(){try{return Ce("get_measurement_content_formats")[0]||null}catch(e){throw new Error(`Error getting measurement scales: ${e.message}`)}}async removeMeasurementScale(e){try{Ce("remove_measurement_content_format",{measurementContentFormat:x(e)})}catch(t){throw new Error(`Error removing ${e.name} measurement scale: ${t.message}`)}}async addMeasurementScale(e){try{Ce("add_measurement_content_format",{measurementContentFormat:x(e)})}catch(t){throw new Error(`Error adding ${e.name} measurement scale: ${t.message}`)}}async getAnnotationsByScale(e){try{return Ce("get_annotations_for_measurement_content_format",{measurementContentFormat:x(e)})||null}catch(e){throw e}}async exportFile(e,t,n,r,i,a,s,c){let u,l={mimeType:"application/pdf",extension:"pdf"};try{const o=!1;u=Ce("save_document",{file_path:ce,format:r,flatten_annotations:e,save_incrementally:t,apply_redactions:o,save_for_printing:n,remove_all_annotations:i,preserve_change_tracker_state:a,...s?{user_password:s.userPassword,owner_password:s.ownerPassword,document_permissions:Ze(s.documentPermissions)}:null}),c&&(c.forEach((e=>{let{pageIndex:t,id:n,pdfObjectId:r}=e;Ce("electronic_signatures/flatten",{page:t,annotation_id:this._getPdfObjectIdForObject({id:n,pdfObjectId:r})})})),u=Ce("save_document",{file_path:ue,format:r,flatten_annotations:e,save_incrementally:t,apply_redactions:o,save_for_printing:n,remove_all_annotations:i,preserve_change_tracker_state:a,...s?{user_password:s.userPassword,owner_password:s.ownerPassword,document_permissions:Ze(s.documentPermissions)}:null}))}catch(e){throw new Error(`Error saving to /save.pdf: ${e.message}`)}const d=u[0];d.format&&(l={mimeType:d.format.mime_type,extension:d.format.extension}),o(pe,de);const p=pe.FS.readFile(c?ue:ce).buffer;return c&&(De("closeDocument"),De("openDocument",ce,JSON.stringify({password:ye}))),[p,l]}async importXFDF(e,t,n){he.push({source:e,keepCurrentAnnotations:t}),t||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.push("pspdfkit/widget"),De("removeAllAnnotations",JSON.stringify(e),JSON.stringify(t))}(),De("importXFDF",e,n)}async exportXFDF(e){return De("exportXFDF",[],[],e).XFDF}async importInstantJSON(e){De("importInstantDocumentJSON",JSON.stringify(e))}async exportInstantJSON(e){const t=Ue;Ue&&ze(!1);const n=De("exportInstantDocumentJSON","number"==typeof e?e:-1);return t&&ze(!0),JSON.parse(n.InstantDocumentJSON)}async getDocumentOutline(){const e=Ce("get_outline");return o(1===e.length,"expected only one response for getDocumentOutline"),e[0].outline||[]}async setDocumentOutline(e){return Ce("set_outline",{outline:e})}async getPageGlyphs(e){return Ce("get_glyphs",{page:e})[0].glyphs||[]}async onKeystrokeEvent(e){const t=Ce("on_keystroke_event",{pdf_javascript_event:e});o(1===t.length,"expected only one response for onKeystrokeEvent");const n=t[0].changes||[];return o(n.length>0&&4===n[0].change_type,"expected onKeystrokeEvent to return at least one JavaScript Event change."),n}async version(){return De("PSPDFKitVersion").version}getImportedXFDF(){return he}async applyRedactions(){try{De("saveDocument",ce,!1,!1,!0,!1,"pdf",!1)}catch(e){throw new Error(`Error applying redactions and saving to /create.pdf: ${e.message}`)}}async clearAPStreamCache(){De("clearAPStreamCache")}async setComparisonDocument(e,t){this.comparisonDocuments[e]=t||(await this.exportFile(!1,!1,!1,"pdf",!1,!1))[0]}async openComparisonDocument(e){return o(this.comparisonDocuments[e]),e===this.lastOpenedComparisonDocument||e===U&&null===this.lastOpenedComparisonDocument&&this.persistedOpenDocument instanceof ArrayBuffer?null:(this.lastOpenedComparisonDocument=e,this.openDocument(this.comparisonDocuments[e],this.persistedOpenDocument===e?this.persistedOpenDocumentPassword:void 0))}async documentCompareAndOpen(e){o(this.comparisonDocuments[U]&&this.comparisonDocuments[L],"One or both comparison input documents are missing.");const t=`${U}.pdf`,n=`${L}.pdf`;pe.FS.writeFile(t,new Uint8Array(this.comparisonDocuments[U])),pe.FS.writeFile(n,new Uint8Array(this.comparisonDocuments[L]));return Ce("comparison",{documentA:{strokeColor:e.documentA.strokeColor,pageIndex:e.documentA.pageIndex,filePath:t},documentB:{strokeColor:e.documentB.strokeColor,pageIndex:e.documentB.pageIndex,filePath:n},options:{...e.options,outputFilePath:"output.pdf"}}),await this.closeDocument(),this.comparisonDocuments[z]=pe.FS.readFile("output.pdf").buffer,this.lastOpenedComparisonDocument=z,this.openDocument(this.comparisonDocuments[z],void 0)}async persistOpenDocument(e){if(e)this.persistedOpenDocument=e;else try{this.persistedOpenDocument=(await this.exportFile(!1,!1,!1,"pdf",!1,!0))[0]}catch(e){throw new Error(`Error trying to persist a copy of the currently opened document: ${e.message}`)}this.persistedOpenDocumentPassword=ye}async cleanupDocumentComparison(){o(this.persistedOpenDocument,"No persisted previous document key or array buffer is available.");const e=this.persistedOpenDocument instanceof ArrayBuffer?this.persistedOpenDocument:this.comparisonDocuments[this.persistedOpenDocument];o(e,"No persisted previous array buffer is available.");try{await this.closeDocument()}catch(e){throw new Error(`Error trying to close the current document: ${e.message}`)}const t=this.openDocument(e,this.persistedOpenDocumentPassword);return this.persistedOpenDocument=null,this.persistedOpenDocumentPassword=null,this.lastOpenedComparisonDocument=null,this.comparisonDocuments={},t}_getPdfObjectIdForObject(e){return"number"==typeof e.pdfObjectId?e.pdfObjectId:this._pdfObjectIdsForIds[e.id]}async getOCGs(){return Ce("ocg/get_ocgs")[0].ocgs}async getOCGVisibilityState(){return{visibleLayerIds:Ce("ocg/get_visibility_state")[0].state.visible}}async setOCGVisibilityState(e){return Ce("ocg/set_visibility_state",{state:{visible:e.visibleLayerIds}})}async dispatchCommand(e){let t,n=null;Fe&&(t=performance.now());try{if(n=await pe.dispatchCommand(e),null===n)throw Error("dispatchCommand returned null");if(n.hasError())return{success:!1,message:n.getErrorMessage(),code:n.getErrorReason()};const r={success:!0,values:[]};for(let e=0;e<n.getRepliesCount();e++)n.hasJSONReply(e)&&r.values.push(JSON.parse(n.getJSONReply(e))),n.hasBinaryReply(e)&&r.values.push(n.getBinaryReply(e).slice(0));if(Fe){const n=JSON.parse(e);Ie.push({type:xe.Daemon,name:n.type,args:n,time:performance.now()-t})}return r}finally{n&&n.delete()}}async getCoreCallRecording(){return Ie}async enableCoreCallRecording(e){Fe=e}recycle(){}destroy(){}},Xe=self;Xe.global=Xe,Xe.module={},Xe.onmessage=async e=>{let t,n,{data:r}=e;try{const e=await Ye[r.action](...r.args);if(t={id:r.id,result:e},Array.isArray(e)){const t=e.filter((e=>e instanceof ArrayBuffer));t.length>0&&(n=t)}e instanceof ArrayBuffer&&(n=[e])}catch(e){const o=[...r.args].filter((e=>e instanceof ArrayBuffer));o.length>0&&(n=o),t={id:r.id,error:e.message||e.toString(),callArgs:r.args}}Xe.postMessage(t,n)}})(),r})()));